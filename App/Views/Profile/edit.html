{% extends "base.html" %}

{% block title %}Profile{% endblock %}


{% block footer %}
    <script src="/js/hideShowPassword.min.js"></script>
    <script src="/js/app.js"></script>    

    <script>
        

        $(document).ready(function(){

            var userId = '{{ user.id }}';
            
            $('#formProfile').validate({
                rules: {
                    name: 'required',
                    email: {
                        required: true,
                        email: true,
                        remote: {
                            url: '/account/validate-email',
                            data: {
                                ignore_id:function() {
                                    return userId;
                                }
                            }

                        } 
                    },
                    password: {
                        minlength: 6,
                        validPassword: true
                    },
                    // password_confirmation: {
                    
                    //     equalTo: '#inputPassword'
                    // }
                },
                messages: {
                    email: {
                        remote: 'email already taken'
                    }
                }
            });

            /**
             * Show password toggle button
             *  
             */
            $('#inputPassword').hideShowPassword({
                show: false, 
                innerToggle: 'focus'
            });
        });

    </script>

{% endblock %}


{% block body %}
<div class="container-fluid">
    <div class="container mt-3 p-3" id="menu-left">

        <h1>Edytuj Profil</h1>

        {% if user.errors is not empty %}
            <p>Errors:</p>
            <ul>
                {% for error in user.errors %}
                    <li>{{ error }}</li>
                    {% endfor %}
            </ul>

        {% endif %}    


        <form method = "POST" id="formProfile" action="/profile/update">
            <div class="form-group">
                <label for="inputName"><b>Imię</b></label>
                <input id="inputName" name="name" placeholder="Name" value="{{ user.name }}" required class="form-control"/>
            </div>
            <div class="form-group mt-2">
                <label for="inputEmail"><b>Email</b></label>
                <input id="inputEmail" name="email" placeholder="email" value="{{ user.email }}" required type="email" class="form-control"/>
            </div>
            <div class="form-group mb-2 mt-2">
                <label for="inputPassword"><b>Hasło</b></label>
                <input type="password" id="inputPassword" name="password" placeholder="Hasło" aria-describedby="helpBlock" class="form-control"/>
                <span id = "helpBlock" class="help-block">Pozostaw puste by zachować obecne hasło</span>
            </div>
            <!-- <div>
                <label for="inputPasswordConfirmation">Password</label>
                <input type="password" id="inputPasswordConfirmation" name="password_confirmation" placeholder="Repeat password"/>
            </div> -->

            <button type="submit" class="btn btn-primary">Zapisz zmiany</button>
            <a href="/profile/show">Anuluj</a>


        </form>

    </div>
</div>

{% endblock %}